<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>åŒ—æ–—æ•™è‚² | è­‰ç…§æ¨¡æ“¬è€ƒ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700&display=swap');
        body { font-family: 'Noto Sans TC', sans-serif; }
        .gradient-bg { background: linear-gradient(135deg, #0f172a 0%, #1e3a5f 50%, #0f172a 100%); }
        .card { background: rgba(30, 41, 59, 0.8); border: 1px solid rgba(255,255,255,0.1); }
        .option-btn { transition: all 0.2s; }
        .option-btn:hover { transform: translateX(4px); }
        .option-btn.selected { border-color: #f59e0b; background: rgba(245,158,11,0.1); }
        .option-btn.correct { border-color: #22c55e; background: rgba(34,197,94,0.1); }
        .option-btn.wrong { border-color: #ef4444; background: rgba(239,68,68,0.1); }
    </style>
</head>
<body class="gradient-bg min-h-screen text-white">

    <nav class="py-4 px-6 border-b border-white/10">
        <div class="container mx-auto flex justify-between items-center">
            <a href="index.html" class="flex items-center gap-2">
                <span class="text-2xl">ğŸŒŸ</span>
                <span class="font-bold text-xl">åŒ—æ–—æ•™è‚²</span>
            </a>
            <div class="flex items-center gap-4">
                <a href="ai_courses.html" class="text-gray-300 hover:text-white">â† è¿”å›èª²ç¨‹</a>
                <a href="cert_learn.html" class="text-blue-400 hover:text-blue-300">ğŸ“– XTF å­¸ç¿’</a>
            </div>
        </div>
    </nav>

    <main class="container mx-auto px-4 py-8 max-w-4xl">
        <!-- é¸æ“‡è­‰ç…§ -->
        <div id="selectPanel" class="card rounded-2xl p-8">
            <h1 class="text-3xl font-bold text-center mb-8">ğŸ¯ è­‰ç…§æ¨¡æ“¬è€ƒ</h1>
            
            <div class="grid md:grid-cols-2 gap-4 mb-8">
                <button onclick="startExam('google_ai')" class="cert-card p-6 rounded-xl bg-gradient-to-r from-blue-600/30 to-purple-600/30 border border-blue-500/30 hover:border-blue-400 transition text-left">
                    <div class="text-3xl mb-2">ğŸ¤–</div>
                    <div class="font-bold text-lg">Google AI Essentials</div>
                    <div class="text-sm text-gray-400 mt-1">358 é¡Œ</div>
                </button>
                
                <button onclick="startExam('aws_ai')" class="cert-card p-6 rounded-xl bg-gradient-to-r from-orange-600/30 to-yellow-600/30 border border-orange-500/30 hover:border-orange-400 transition text-left">
                    <div class="text-3xl mb-2">â˜ï¸</div>
                    <div class="font-bold text-lg">AWS AI Services</div>
                    <div class="text-sm text-gray-400 mt-1">1,568 é¡Œ</div>
                </button>
                
                <button onclick="startExam('azure_ai')" class="cert-card p-6 rounded-xl bg-gradient-to-r from-indigo-600/30 to-blue-600/30 border border-indigo-500/30 hover:border-indigo-400 transition text-left">
                    <div class="text-3xl mb-2">ğŸ”·</div>
                    <div class="font-bold text-lg">Azure AI-900</div>
                    <div class="text-sm text-gray-400 mt-1">49 é¡Œ</div>
                </button>
                
                <button onclick="startExam('ipas')" class="cert-card p-6 rounded-xl bg-gradient-to-r from-green-600/30 to-teal-600/30 border border-green-500/30 hover:border-green-400 transition text-left">
                    <div class="text-3xl mb-2">ğŸ›¡ï¸</div>
                    <div class="font-bold text-lg">iPAS è³‡è¨Šå®‰å…¨å·¥ç¨‹å¸«</div>
                    <div class="text-sm text-gray-400 mt-1">510 é¡Œ</div>
                </button>
            </div>
            
            <div class="text-center">
                <label class="flex items-center justify-center gap-2 text-gray-400">
                    <input type="number" id="questionCount" value="10" min="5" max="50" class="w-16 bg-slate-700 rounded px-2 py-1 text-white text-center">
                    <span>é¡Œ/å›</span>
                </label>
            </div>
        </div>

        <!-- ç­”é¡Œå€ -->
        <div id="examPanel" class="hidden">
            <!-- é€²åº¦æ¢ -->
            <div class="card rounded-xl p-4 mb-6">
                <div class="flex justify-between items-center mb-2">
                    <span id="certName" class="font-bold">Google AI</span>
                    <span id="progressText">1 / 10</span>
                </div>
                <div class="h-2 bg-gray-700 rounded-full overflow-hidden">
                    <div id="progressBar" class="h-full bg-gradient-to-r from-blue-500 to-purple-500 rounded-full transition-all" style="width: 10%"></div>
                </div>
            </div>

            <!-- é¡Œç›®å¡ -->
            <div class="card rounded-2xl p-6 mb-6">
                <div class="flex items-center gap-2 mb-4">
                    <span id="qNumber" class="bg-blue-600 px-3 py-1 rounded-full text-sm font-bold">Q1</span>
                    <span id="qDifficulty" class="text-yellow-400">â­â­</span>
                </div>
                
                <div id="questionText" class="text-lg leading-relaxed mb-6">
                    é¡Œç›®è¼‰å…¥ä¸­...
                </div>

                <div id="optionsContainer" class="space-y-3">
                    <!-- é¸é …æœƒå‹•æ…‹ç”Ÿæˆ -->
                </div>
            </div>

            <!-- è§£æå€ (ç­”é¡Œå¾Œé¡¯ç¤º) -->
            <div id="explanationPanel" class="card rounded-xl p-6 mb-6 hidden">
                <h3 class="font-bold text-green-400 mb-3">ğŸ“ è§£æ</h3>
                <div id="explanationText" class="text-gray-300 leading-relaxed"></div>
            </div>

            <!-- æ“ä½œæŒ‰éˆ• -->
            <div class="flex gap-4">
                <button onclick="prevQuestion()" id="btnPrev" class="flex-1 bg-slate-700 hover:bg-slate-600 py-3 rounded-xl font-bold disabled:opacity-50" disabled>
                    â† ä¸Šä¸€é¡Œ
                </button>
                <button onclick="nextQuestion()" id="btnNext" class="flex-1 bg-gradient-to-r from-blue-500 to-purple-600 hover:from-blue-400 hover:to-purple-500 py-3 rounded-xl font-bold">
                    ä¸‹ä¸€é¡Œ â†’
                </button>
            </div>
        </div>

        <!-- çµæœå€ -->
        <div id="resultPanel" class="card rounded-2xl p-8 hidden">
            <h2 class="text-3xl font-bold text-center mb-6">ğŸ‰ æ¸¬é©—å®Œæˆï¼</h2>
            
            <div class="text-center mb-8">
                <div class="text-6xl font-bold mb-2">
                    <span id="scorePercent">80</span>%
                </div>
                <div class="text-gray-400">
                    ç­”å° <span id="correctCount">8</span> / <span id="totalCount">10</span> é¡Œ
                </div>
            </div>

            <div class="grid grid-cols-2 gap-4 mb-8">
                <div class="bg-green-900/30 rounded-xl p-4 text-center">
                    <div class="text-2xl font-bold text-green-400" id="statCorrect">8</div>
                    <div class="text-sm text-gray-400">ç­”å°</div>
                </div>
                <div class="bg-red-900/30 rounded-xl p-4 text-center">
                    <div class="text-2xl font-bold text-red-400" id="statWrong">2</div>
                    <div class="text-sm text-gray-400">ç­”éŒ¯</div>
                </div>
            </div>

            <div class="flex gap-4">
                <button onclick="location.reload()" class="flex-1 bg-slate-700 hover:bg-slate-600 py-3 rounded-xl font-bold">
                    é‡æ–°é¸æ“‡
                </button>
                <button onclick="retryExam()" class="flex-1 bg-gradient-to-r from-blue-500 to-purple-600 hover:from-blue-400 hover:to-purple-500 py-3 rounded-xl font-bold">
                    å†æ¸¬ä¸€æ¬¡
                </button>
            </div>
        </div>
    </main>

    <script>
        let questions = [];
        let currentIndex = 0;
        let answers = [];
        let currentCert = '';

        const certNames = {
            'google_ai': 'Google AI Essentials',
            'aws_ai': 'AWS AI Services',
            'azure_ai': 'Azure AI-900',
            'azure_cloud': 'Azure AZ-900',
            'azure_data': 'Azure DP-900',
            'ipas': 'iPAS è³‡è¨Šå®‰å…¨å·¥ç¨‹å¸«'
        };

        async function startExam(cert) {
            currentCert = cert;
            const count = parseInt(document.getElementById('questionCount').value) || 10;
            
            try {
                const res = await fetch(`data/cert_q_${cert}.json`);
                const data = await res.json();
                
                // éš¨æ©ŸæŠ½é¡Œ
                const shuffled = data.questions.sort(() => Math.random() - 0.5);
                questions = shuffled.slice(0, Math.min(count, shuffled.length));
                
                currentIndex = 0;
                answers = new Array(questions.length).fill(null);
                
                document.getElementById('selectPanel').classList.add('hidden');
                document.getElementById('examPanel').classList.remove('hidden');
                document.getElementById('certName').textContent = certNames[cert] || cert;
                
                showQuestion();
            } catch (e) {
                console.error('è¼‰å…¥å¤±æ•—:', e);
                alert('é¡Œåº«è¼‰å…¥å¤±æ•—ï¼Œè«‹ç¨å¾Œå†è©¦');
            }
        }

        function showQuestion() {
            const q = questions[currentIndex];
            
            // æ›´æ–°é€²åº¦
            document.getElementById('progressText').textContent = `${currentIndex + 1} / ${questions.length}`;
            document.getElementById('progressBar').style.width = `${((currentIndex + 1) / questions.length) * 100}%`;
            document.getElementById('qNumber').textContent = `Q${currentIndex + 1}`;
            document.getElementById('qDifficulty').textContent = 'â­'.repeat(q.difficulty || 2);
            
            // é¡Œç›®
            document.getElementById('questionText').textContent = q.question;
            
            // é¸é …
            const container = document.getElementById('optionsContainer');
            container.innerHTML = '';
            
            const options = q.options || [];
            options.forEach((opt, i) => {
                const optText = typeof opt === 'object' ? opt.text : opt;
                const optId = typeof opt === 'object' ? opt.id : String.fromCharCode(65 + i);
                
                const btn = document.createElement('button');
                btn.className = 'option-btn w-full text-left p-4 rounded-xl border border-white/20 hover:border-white/40';
                btn.innerHTML = `<span class="font-bold mr-2">${optId}.</span>${optText.replace(/^[A-D]\.\s*/, '')}`;
                btn.onclick = () => selectOption(optId, btn);
                
                // å¦‚æœå·²ç¶“ç­”é
                if (answers[currentIndex] !== null) {
                    const isCorrect = optId === q.answer;
                    const isSelected = optId === answers[currentIndex];
                    
                    if (isCorrect) btn.classList.add('correct');
                    else if (isSelected) btn.classList.add('wrong');
                    btn.disabled = true;
                }
                
                container.appendChild(btn);
            });
            
            // è§£æ
            const expPanel = document.getElementById('explanationPanel');
            if (answers[currentIndex] !== null) {
                expPanel.classList.remove('hidden');
                document.getElementById('explanationText').textContent = q.explanation || 'æš«ç„¡è§£æ';
            } else {
                expPanel.classList.add('hidden');
            }
            
            // æŒ‰éˆ•ç‹€æ…‹
            document.getElementById('btnPrev').disabled = currentIndex === 0;
            document.getElementById('btnNext').textContent = 
                currentIndex === questions.length - 1 ? 'æŸ¥çœ‹çµæœ' : 'ä¸‹ä¸€é¡Œ â†’';
        }

        function selectOption(optId, btn) {
            if (answers[currentIndex] !== null) return;
            
            answers[currentIndex] = optId;
            const q = questions[currentIndex];
            const isCorrect = optId === q.answer;
            
            // æ¨™è¨˜æ‰€æœ‰é¸é …
            document.querySelectorAll('.option-btn').forEach(b => {
                const bId = b.textContent.charAt(0);
                if (bId === q.answer) b.classList.add('correct');
                else if (bId === optId) b.classList.add('wrong');
                b.disabled = true;
            });
            
            // é¡¯ç¤ºè§£æ
            document.getElementById('explanationPanel').classList.remove('hidden');
            document.getElementById('explanationText').textContent = q.explanation || 'æš«ç„¡è§£æ';
        }

        function nextQuestion() {
            if (currentIndex < questions.length - 1) {
                currentIndex++;
                showQuestion();
            } else {
                showResult();
            }
        }

        function prevQuestion() {
            if (currentIndex > 0) {
                currentIndex--;
                showQuestion();
            }
        }

        function showResult() {
            const correct = answers.filter((a, i) => a === questions[i].answer).length;
            const total = questions.length;
            const pct = Math.round((correct / total) * 100);
            
            document.getElementById('examPanel').classList.add('hidden');
            document.getElementById('resultPanel').classList.remove('hidden');
            
            document.getElementById('scorePercent').textContent = pct;
            document.getElementById('correctCount').textContent = correct;
            document.getElementById('totalCount').textContent = total;
            document.getElementById('statCorrect').textContent = correct;
            document.getElementById('statWrong').textContent = total - correct;
        }

        function retryExam() {
            document.getElementById('resultPanel').classList.add('hidden');
            startExam(currentCert);
        }
    </script>
</body>
</html>
