<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>XTF è¤‡ç¿’å¡ - åŒ—æ–—æ•™è‚²</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .flip-card { perspective: 1000px; }
        .flip-card-inner { transition: transform 0.6s; transform-style: preserve-3d; }
        .flip-card.flipped .flip-card-inner { transform: rotateY(180deg); }
        .flip-card-front, .flip-card-back { backface-visibility: hidden; }
        .flip-card-back { transform: rotateY(180deg); }
        .progress-ring { transform: rotate(-90deg); }
    </style>
<!-- Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-8X0VB6K9G7"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag("js", new Date());
  gtag("config", "G-8X0VB6K9G7");
</script>
</head>
<body class="bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 min-h-screen text-white">
    
    <!-- Header -->
    <header class="bg-black/30 backdrop-blur-md border-b border-white/10 sticky top-0 z-50">
        <div class="max-w-6xl mx-auto px-4 py-4 flex justify-between items-center">
            <div class="flex items-center gap-3">
                <div class="text-2xl">â­</div>
                <span class="text-xl font-bold">åŒ—æ–—æ•™è‚²</span>
                <span class="text-sm text-purple-300">XTF è¤‡ç¿’å¡</span>
            </div>
            <div id="userStats" class="flex items-center gap-4 text-sm">
                <span class="text-purple-300">è¼‰å…¥ä¸­...</span>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="max-w-4xl mx-auto px-4 py-8">
        
        <!-- Stats Panel -->
        <section id="statsPanel" class="bg-white/5 rounded-2xl p-6 mb-8 border border-white/10">
            <div class="grid grid-cols-2 md:grid-cols-5 gap-4 text-center">
                <div>
                    <div class="text-3xl font-bold text-purple-400" id="statDue">0</div>
                    <div class="text-sm text-gray-400">å¾…è¤‡ç¿’</div>
                </div>
                <div>
                    <div class="text-3xl font-bold text-green-400" id="statMastered">0</div>
                    <div class="text-sm text-gray-400">å·²æŒæ¡</div>
                </div>
                <div>
                    <div class="text-3xl font-bold text-yellow-400" id="statReviewing">0</div>
                    <div class="text-sm text-gray-400">è¤‡ç¿’ä¸­</div>
                </div>
                <div>
                    <div class="text-3xl font-bold text-blue-400" id="statLearning">0</div>
                    <div class="text-sm text-gray-400">å­¸ç¿’ä¸­</div>
                </div>
                <div>
                    <div class="text-3xl font-bold text-white" id="statAccuracy">0%</div>
                    <div class="text-sm text-gray-400">æ­£ç¢ºç‡</div>
                </div>
            </div>
        </section>

        <!-- Cert Selector -->
        <section class="mb-8 flex flex-wrap gap-2 justify-center">
            <button onclick="selectCert('all')" class="cert-btn px-4 py-2 rounded-full bg-purple-600 text-white text-sm" data-cert="all">å…¨éƒ¨</button>
            <button onclick="selectCert('CERT001')" class="cert-btn px-4 py-2 rounded-full bg-white/10 text-white text-sm" data-cert="CERT001">Google AI</button>
            <button onclick="selectCert('CERT002')" class="cert-btn px-4 py-2 rounded-full bg-white/10 text-white text-sm" data-cert="CERT002">AWS AI</button>
            <button onclick="selectCert('CERT003')" class="cert-btn px-4 py-2 rounded-full bg-white/10 text-white text-sm" data-cert="CERT003">Azure AI-900</button>
            <button onclick="selectCert('IPAS_ISE_BASIC')" class="cert-btn px-4 py-2 rounded-full bg-white/10 text-white text-sm" data-cert="IPAS_ISE_BASIC">iPAS è³‡å®‰</button>
        </section>

        <!-- Flashcard Area -->
        <section id="cardArea" class="mb-8">
            <div class="flip-card w-full h-80 cursor-pointer" onclick="flipCard()">
                <div class="flip-card-inner w-full h-full relative">
                    <!-- Front -->
                    <div class="flip-card-front absolute w-full h-full bg-gradient-to-br from-purple-600 to-indigo-700 rounded-2xl p-8 flex flex-col justify-center items-center border border-white/20 shadow-xl">
                        <div class="text-sm text-purple-200 mb-2" id="cardCert">è­‰ç…§åç¨±</div>
                        <div class="text-2xl font-bold text-center mb-4" id="cardNodeId">ç¯€é» ID</div>
                        <div class="text-lg text-center text-purple-100" id="cardQuestion">é»æ“Šç¿»è½‰æŸ¥çœ‹ç­”æ¡ˆ</div>
                        <div class="text-4xl mt-4">â“</div>
                    </div>
                    <!-- Back -->
                    <div class="flip-card-back absolute w-full h-full bg-gradient-to-br from-green-600 to-teal-700 rounded-2xl p-8 border border-white/20 shadow-xl overflow-y-auto">
                        <div class="space-y-4">
                            <div>
                                <div class="text-xs text-green-200 uppercase">ç™½è©±è§£é‡‹</div>
                                <div class="text-lg font-semibold" id="cardPlain">-</div>
                            </div>
                            <div>
                                <div class="text-xs text-green-200 uppercase">å£è¨£</div>
                                <div class="text-xl font-bold text-yellow-300" id="cardMnemonic">-</div>
                            </div>
                            <div>
                                <div class="text-xs text-green-200 uppercase">è€ƒè©¦æŠ€å·§</div>
                                <div class="text-sm" id="cardTips">-</div>
                            </div>
                            <div>
                                <div class="text-xs text-green-200 uppercase">å¯¦å‹™æ‡‰ç”¨</div>
                                <div class="text-sm text-green-100" id="cardRealWorld">-</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Progress -->
            <div class="text-center text-sm text-gray-400 mt-4">
                <span id="cardProgress">0 / 0</span>
            </div>
        </section>

        <!-- Control Buttons -->
        <section id="controlArea" class="flex justify-center gap-4 mb-8">
            <button onclick="markAnswer(false)" class="px-8 py-4 bg-red-600 hover:bg-red-700 rounded-xl text-lg font-bold transition-all transform hover:scale-105 disabled:opacity-50" id="btnWrong">
                âŒ å¿˜è¨˜äº†
            </button>
            <button onclick="markAnswer(true)" class="px-8 py-4 bg-green-600 hover:bg-green-700 rounded-xl text-lg font-bold transition-all transform hover:scale-105 disabled:opacity-50" id="btnCorrect">
                âœ… è¨˜å¾—ï¼
            </button>
        </section>

        <!-- Session Summary -->
        <section id="summaryPanel" class="hidden bg-white/5 rounded-2xl p-8 text-center border border-white/10">
            <div class="text-4xl mb-4">ğŸ‰</div>
            <h2 class="text-2xl font-bold mb-4">ä»Šæ—¥è¤‡ç¿’å®Œæˆï¼</h2>
            <div class="grid grid-cols-2 gap-4 mb-6">
                <div>
                    <div class="text-3xl font-bold text-green-400" id="summaryCorrect">0</div>
                    <div class="text-sm text-gray-400">ç­”å°</div>
                </div>
                <div>
                    <div class="text-3xl font-bold text-red-400" id="summaryWrong">0</div>
                    <div class="text-sm text-gray-400">ç­”éŒ¯</div>
                </div>
            </div>
            <button onclick="startNewSession()" class="px-6 py-3 bg-purple-600 hover:bg-purple-700 rounded-xl font-bold">
                é‡æ–°é–‹å§‹
            </button>
        </section>

        <!-- Next Review Preview -->
        <section class="bg-white/5 rounded-2xl p-6 border border-white/10">
            <h3 class="text-lg font-bold mb-4">ğŸ“… è¤‡ç¿’æ’ç¨‹</h3>
            <div id="calendarPreview" class="space-y-2">
                <div class="text-gray-400 text-sm">è¼‰å…¥ä¸­...</div>
            </div>
        </section>
    </main>

    <script>
        // ============================================================
        // é…ç½®
        // ============================================================
        const API_BASE = 'https://beidou-edu-server-1.onrender.com/api';
        const USER_ID = 'demo_user';   // å¯¦éš›æ‡‰å¾ç™»å…¥å–å¾—
        
        // ============================================================
        // ç‹€æ…‹
        // ============================================================
        let currentCert = 'all';
        let cards = [];
        let currentIndex = 0;
        let sessionCorrect = 0;
        let sessionWrong = 0;
        let isFlipped = false;

        // ============================================================
        // åˆå§‹åŒ–
        // ============================================================
        document.addEventListener('DOMContentLoaded', () => {
            loadStats();
            loadDueCards();
            loadCalendar();
        });

        // ============================================================
        // è¼‰å…¥æ•¸æ“š
        // ============================================================
        async function loadStats() {
            try {
                // æ¨¡æ“¬æ•¸æ“š (å¯¦éš›é€£æ¥ API)
                const stats = {
                    due_today: 15,
                    mastered: 28,
                    reviewing: 12,
                    learning: 5,
                    accuracy: 82.5
                };
                
                document.getElementById('statDue').textContent = stats.due_today;
                document.getElementById('statMastered').textContent = stats.mastered;
                document.getElementById('statReviewing').textContent = stats.reviewing;
                document.getElementById('statLearning').textContent = stats.learning;
                document.getElementById('statAccuracy').textContent = stats.accuracy + '%';
            } catch (err) {
                console.error('è¼‰å…¥çµ±è¨ˆå¤±æ•—:', err);
            }
        }

        async function loadDueCards() {
            try {
                // æ¨¡æ“¬æ•¸æ“š (å¯¦éš›å¾ API ç²å–)
                cards = [
                    {
                        node_id: 'GAI_RAG_001',
                        cert_id: 'CERT001',
                        cert_name: 'Google AI Essentials',
                        definition: 'RAG retrieves relevant documents before generating responses.',
                        plain: 'RAG = å…ˆæŸ¥è³‡æ–™å†å›ç­”ï¼Œæ¸›å°‘èƒ¡èªªã€‚',
                        mnemonic: 'RAG = æŸ¥-å¢-ç”Ÿ',
                        tips: 'æ¸›å°‘å¹»è¦ºçš„æ ¸å¿ƒæŠ€è¡“ï¼',
                        real_world: 'ä¼æ¥­çŸ¥è­˜åº«å•ç­”'
                    },
                    {
                        node_id: 'ISE_MGT_CIA_001',
                        cert_id: 'IPAS_ISE_BASIC',
                        cert_name: 'iPAS è³‡å®‰å·¥ç¨‹å¸«',
                        definition: 'CIA ä¸‰å…ƒçµ„æ˜¯è³‡è¨Šå®‰å…¨çš„æ ¸å¿ƒç›®æ¨™ã€‚',
                        plain: 'CIA = æ©Ÿå¯†æ€§ã€å®Œæ•´æ€§ã€å¯ç”¨æ€§ã€‚',
                        mnemonic: 'æ©Ÿå®Œç”¨ = CIA',
                        tips: 'å¹¾ä¹æ¯æ¬¡å¿…è€ƒï¼',
                        real_world: 'è³‡å®‰æ”¿ç­–åˆ¶å®š'
                    },
                    {
                        node_id: 'AWS_BEDROCK_002',
                        cert_id: 'CERT002',
                        cert_name: 'AWS AI Practitioner',
                        definition: 'Amazon Bedrock provides access to foundation models.',
                        plain: 'Bedrock = AWS çš„ AI æ¨¡å‹å•†åŸã€‚',
                        mnemonic: 'Bedrock = åŸºå²© = AI åŸºç¤',
                        tips: 'è¨˜ä½æ”¯æ´çš„ FM æä¾›å•†',
                        real_world: 'Enterprise AI æ‡‰ç”¨'
                    },
                    {
                        node_id: 'AZ_RESP_001',
                        cert_id: 'CERT003',
                        cert_name: 'Azure AI-900',
                        definition: 'Microsoft Responsible AI å…­å¤§åŸå‰‡ã€‚',
                        plain: 'å¾®è»Ÿè² è²¬ä»» AI = å…­å¤§åŸå‰‡ç¢ºä¿ AI å€«ç†ã€‚',
                        mnemonic: 'å…¬å¯éš±åŒ…é€è²¬ = FRPITA',
                        tips: 'å…­å¤§åŸå‰‡å¿…èƒŒï¼',
                        real_world: 'ä¼æ¥­ AI æ²»ç†'
                    },
                    {
                        node_id: 'ISE_TECH_AAA_001',
                        cert_id: 'IPAS_ISE_BASIC',
                        cert_name: 'iPAS è³‡å®‰å·¥ç¨‹å¸«',
                        definition: 'AAA = Authentication, Authorization, Accounting',
                        plain: 'AAA = ä½ æ˜¯èª° + ä½ èƒ½åšä»€éº¼ + è¨˜éŒ„ä½ åšäº†ä»€éº¼ã€‚',
                        mnemonic: 'AAA = èªæˆè¨˜',
                        tips: 'ä¸‰Aå¿…èƒŒï¼å€åˆ†èªè­‰ vs æˆæ¬Š',
                        real_world: 'RADIUSã€TACACS+'
                    }
                ];
                
                if (cards.length > 0) {
                    showCard(0);
                } else {
                    showSummary();
                }
            } catch (err) {
                console.error('è¼‰å…¥å¡ç‰‡å¤±æ•—:', err);
            }
        }

        async function loadCalendar() {
            try {
                // æ¨¡æ“¬æ•¸æ“š
                const calendar = [
                    { date: 'ä»Šå¤©', count: 15 },
                    { date: 'æ˜å¤©', count: 8 },
                    { date: 'å¾Œå¤©', count: 5 },
                    { date: '3å¤©å¾Œ', count: 12 },
                    { date: 'ä¸€é€±å¾Œ', count: 20 }
                ];
                
                const html = calendar.map(item => `
                    <div class="flex justify-between items-center py-2 border-b border-white/10">
                        <span class="text-gray-300">${item.date}</span>
                        <span class="px-3 py-1 bg-purple-600/30 rounded-full text-sm">${item.count} å¼µ</span>
                    </div>
                `).join('');
                
                document.getElementById('calendarPreview').innerHTML = html;
            } catch (err) {
                console.error('è¼‰å…¥æ—¥æ›†å¤±æ•—:', err);
            }
        }

        // ============================================================
        // å¡ç‰‡æ“ä½œ
        // ============================================================
        function showCard(index) {
            if (index >= cards.length) {
                showSummary();
                return;
            }
            
            const card = cards[index];
            isFlipped = false;
            document.querySelector('.flip-card').classList.remove('flipped');
            
            // æ›´æ–°å‰é¢
            document.getElementById('cardCert').textContent = card.cert_name;
            document.getElementById('cardNodeId').textContent = card.node_id;
            document.getElementById('cardQuestion').textContent = card.definition;
            
            // æ›´æ–°èƒŒé¢
            document.getElementById('cardPlain').textContent = card.plain;
            document.getElementById('cardMnemonic').textContent = card.mnemonic;
            document.getElementById('cardTips').textContent = card.tips;
            document.getElementById('cardRealWorld').textContent = card.real_world;
            
            // æ›´æ–°é€²åº¦
            document.getElementById('cardProgress').textContent = `${index + 1} / ${cards.length}`;
            
            // ç¦ç”¨æŒ‰éˆ•ç›´åˆ°ç¿»å¡
            document.getElementById('btnCorrect').disabled = true;
            document.getElementById('btnWrong').disabled = true;
        }

        function flipCard() {
            isFlipped = !isFlipped;
            document.querySelector('.flip-card').classList.toggle('flipped');
            
            // GA äº‹ä»¶è¿½è¹¤ - ç¿»å¡
            gtag('event', 'flip_card', {
                'event_category': 'flashcard',
                'event_label': cards[currentIndex]?.node_id || 'unknown'
            });
            
            if (isFlipped) {
                document.getElementById('btnCorrect').disabled = false;
                document.getElementById('btnWrong').disabled = false;
            }
        }

        async function markAnswer(isCorrect) {
            if (!isFlipped) return;
            
            const card = cards[currentIndex];
            
            // GA äº‹ä»¶è¿½è¹¤ - æ¨™è¨˜ç­”æ¡ˆ
            gtag('event', 'mark_answer', {
                'event_category': 'flashcard',
                'event_label': isCorrect ? 'correct' : 'wrong'
            });
            
            // è¨˜éŒ„çµæœ (å¯¦éš›æ‡‰å‘¼å« API)
            if (isCorrect) {
                sessionCorrect++;
            } else {
                sessionWrong++;
            }
            
            // ä¸‹ä¸€å¼µ
            currentIndex++;
            showCard(currentIndex);
        }

        function showSummary() {
            document.getElementById('cardArea').classList.add('hidden');
            document.getElementById('controlArea').classList.add('hidden');
            document.getElementById('summaryPanel').classList.remove('hidden');
            
            // GA äº‹ä»¶è¿½è¹¤ - å®Œæˆè¤‡ç¿’
            const total = sessionCorrect + sessionWrong;
            const accuracy = total > 0 ? Math.round((sessionCorrect / total) * 100) : 0;
            gtag('event', 'finish_flashcard', {
                'event_category': 'flashcard',
                'event_label': currentCert,
                'value': accuracy
            });
            
            document.getElementById('summaryCorrect').textContent = sessionCorrect;
            document.getElementById('summaryWrong').textContent = sessionWrong;
        }

        function startNewSession() {
            currentIndex = 0;
            sessionCorrect = 0;
            sessionWrong = 0;
            
            // GA äº‹ä»¶è¿½è¹¤ - é–‹å§‹æ–°è¤‡ç¿’
            gtag('event', 'start_flashcard', {
                'event_category': 'flashcard',
                'event_label': currentCert
            });
            
            document.getElementById('cardArea').classList.remove('hidden');
            document.getElementById('controlArea').classList.remove('hidden');
            document.getElementById('summaryPanel').classList.add('hidden');
            
            loadDueCards();
        }

        // ============================================================
        // è­‰ç…§é¸æ“‡
        // ============================================================
        function selectCert(cert) {
            currentCert = cert;
            
            // GA äº‹ä»¶è¿½è¹¤ - é¸æ“‡è­‰ç…§
            gtag('event', 'select_cert', {
                'event_category': 'flashcard',
                'event_label': cert
            });
            
            // æ›´æ–°æŒ‰éˆ•æ¨£å¼
            document.querySelectorAll('.cert-btn').forEach(btn => {
                if (btn.dataset.cert === cert) {
                    btn.classList.remove('bg-white/10');
                    btn.classList.add('bg-purple-600');
                } else {
                    btn.classList.remove('bg-purple-600');
                    btn.classList.add('bg-white/10');
                }
            });
            
            // é‡æ–°è¼‰å…¥
            currentIndex = 0;
            sessionCorrect = 0;
            sessionWrong = 0;
            loadDueCards();
        }
    </script>
</body>
</html>
