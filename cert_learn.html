<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>åŒ—æ–—æ•™è‚² | è­‰ç…§ XTF å­¸ç¿’</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700&display=swap');
        body { font-family: 'Noto Sans TC', sans-serif; }
        .gradient-bg { background: linear-gradient(135deg, #0f172a 0%, #1e3a5f 50%, #0f172a 100%); }
        .card { background: rgba(30, 41, 59, 0.8); border: 1px solid rgba(255,255,255,0.1); }
        .xtf-tab { transition: all 0.3s; }
        .xtf-tab.active { border-bottom: 3px solid; }
        .xtf-content { display: none; }
        .xtf-content.active { display: block; }
        .node-card { transition: all 0.3s; cursor: pointer; }
        .node-card:hover { transform: translateY(-2px); border-color: rgba(255,255,255,0.3); }
        .node-card.selected { border-color: #f59e0b; background: rgba(245, 158, 11, 0.1); }
        .cert-badge { display: inline-block; padding: 2px 8px; border-radius: 9999px; font-size: 0.75rem; }
    </style>
</head>
<body class="gradient-bg min-h-screen text-white">

    <!-- å°èˆªåˆ— -->
    <nav class="py-4 px-6 border-b border-white/10">
        <div class="container mx-auto flex justify-between items-center">
            <a href="index.html" class="flex items-center gap-2">
                <span class="text-2xl">ğŸŒŸ</span>
                <span class="font-bold text-xl">åŒ—æ–—æ•™è‚²</span>
            </a>
            <div class="hidden md:flex items-center gap-6">
                <a href="ai_courses.html" class="text-gray-300 hover:text-white">AI èªè­‰</a>
                <a href="courses.html" class="text-gray-300 hover:text-white">å­¸æ¸¬èª²ç¨‹</a>
                <a href="battle.html" class="text-orange-400 hover:text-orange-300">âš”ï¸ æˆ°é¬¥</a>
            </div>
            <a href="auth.html" id="authLink" class="text-gray-300 hover:text-white">ç™»å…¥</a>
        </div>
    </nav>

    <main class="container mx-auto px-4 py-8 max-w-6xl">
        <!-- æ¨™é¡Œ -->
        <div class="text-center mb-8">
            <h1 class="text-3xl font-bold mb-2">ğŸ“ è­‰ç…§ XTF å­¸ç¿’</h1>
            <p class="text-gray-400">Google AI Essentials / iPAS è³‡è¨Šå®‰å…¨å·¥ç¨‹å¸«</p>
        </div>

        <div class="grid md:grid-cols-4 gap-6">
            <!-- å·¦å´ï¼šè­‰ç…§èˆ‡ç¯€é»é¸æ“‡ -->
            <div class="md:col-span-1 space-y-4">
                <!-- è­‰ç…§é¸æ“‡ -->
                <div class="card rounded-xl p-4">
                    <h3 class="font-bold mb-3">ğŸ“œ é¸æ“‡è­‰ç…§</h3>
                    <div class="space-y-2">
                        <button onclick="selectCert('google_ai')" id="btn-google_ai" class="cert-btn w-full text-left p-3 rounded-lg bg-gradient-to-r from-blue-600 to-purple-600 border-2 border-transparent">
                            <div class="font-bold">ğŸ¤– Google AI Essentials</div>
                            <div class="text-xs text-gray-300">89 çŸ¥è­˜é»</div>
                        </button>
                        <button onclick="selectCert('aws_ai')" id="btn-aws_ai" class="cert-btn w-full text-left p-3 rounded-lg bg-slate-700 hover:bg-slate-600 border-2 border-transparent">
                            <div class="font-bold">â˜ï¸ AWS AI Practitioner</div>
                            <div class="text-xs text-gray-300">15 çŸ¥è­˜é»</div>
                        </button>
                        <button onclick="selectCert('azure_ai')" id="btn-azure_ai" class="cert-btn w-full text-left p-3 rounded-lg bg-slate-700 hover:bg-slate-600 border-2 border-transparent">
                            <div class="font-bold">ğŸ”· Azure AI Fundamentals</div>
                            <div class="text-xs text-gray-300">10 çŸ¥è­˜é»</div>
                        </button>
                        <button onclick="selectCert('ipas_ise')" id="btn-ipas_ise" class="cert-btn w-full text-left p-3 rounded-lg bg-slate-700 hover:bg-slate-600 border-2 border-transparent">
                            <div class="font-bold">ğŸ›¡ï¸ iPAS è³‡è¨Šå®‰å…¨å·¥ç¨‹å¸«</div>
                            <div class="text-xs text-gray-300">122 çŸ¥è­˜é»</div>
                        </button>
                    </div>
                </div>

                <!-- ç¯€é»åˆ—è¡¨ -->
                <div class="card rounded-xl p-4 max-h-[450px] overflow-y-auto">
                    <h3 class="font-bold mb-3">ğŸ“‹ çŸ¥è­˜ç¯€é» <span id="nodeCount" class="text-gray-400 text-sm">(0)</span></h3>
                    <div id="nodeList" class="space-y-2">
                        <p class="text-gray-500 text-sm">è¼‰å…¥ä¸­...</p>
                    </div>
                </div>
            </div>

            <!-- å³å´ï¼šXTF å…§å®¹ -->
            <div class="md:col-span-3">
                <div class="card rounded-xl overflow-hidden">
                    <!-- XTF æ¨™ç±¤ -->
                    <div class="flex border-b border-white/10">
                        <button onclick="showTab('understand')" class="xtf-tab active flex-1 py-4 text-center border-blue-400 text-blue-400" data-tab="understand">
                            ğŸ”» æ¶ˆ (ç†è§£)
                        </button>
                        <button onclick="showTab('memorize')" class="xtf-tab flex-1 py-4 text-center text-gray-400 hover:text-purple-400" data-tab="memorize">
                            ğŸ”€ æ‹“ (è¨˜æ†¶)
                        </button>
                        <button onclick="showTab('apply')" class="xtf-tab flex-1 py-4 text-center text-gray-400 hover:text-green-400" data-tab="apply">
                            ğŸ”º è (æ‡‰ç”¨)
                        </button>
                    </div>

                    <!-- å…§å®¹å€ -->
                    <div class="p-6">
                        <!-- ç¯€é»æ¨™é¡Œ -->
                        <div id="nodeTitle" class="mb-6">
                            <h2 class="text-2xl font-bold mb-2">é¸æ“‡ä¸€å€‹çŸ¥è­˜ç¯€é»</h2>
                            <p class="text-gray-400">å¾å·¦å´åˆ—è¡¨é¸æ“‡è¦å­¸ç¿’çš„æ¦‚å¿µ</p>
                        </div>

                        <!-- æ¶ˆï¼šç†è§£ -->
                        <div id="tab-understand" class="xtf-content active">
                            <div class="bg-blue-900/20 border border-blue-500/30 rounded-xl p-6">
                                <h3 class="text-lg font-bold text-blue-400 mb-4">ğŸ”» æ¶ˆï¼šç™½è©±ç†è§£</h3>
                                <div id="content-understand" class="text-gray-300 leading-relaxed whitespace-pre-wrap">
                                    é¸æ“‡ç¯€é»å¾Œé¡¯ç¤ºå…§å®¹...
                                </div>
                            </div>
                        </div>

                        <!-- æ‹“ï¼šè¨˜æ†¶ -->
                        <div id="tab-memorize" class="xtf-content">
                            <div class="bg-purple-900/20 border border-purple-500/30 rounded-xl p-6">
                                <h3 class="text-lg font-bold text-purple-400 mb-4">ğŸ”€ æ‹“ï¼šé€£çµè¨˜æ†¶</h3>
                                <div id="content-memorize" class="text-gray-300 leading-relaxed whitespace-pre-wrap">
                                    é¸æ“‡ç¯€é»å¾Œé¡¯ç¤ºå…§å®¹...
                                </div>
                            </div>
                        </div>

                        <!-- èï¼šæ‡‰ç”¨ -->
                        <div id="tab-apply" class="xtf-content">
                            <div class="bg-green-900/20 border border-green-500/30 rounded-xl p-6">
                                <h3 class="text-lg font-bold text-green-400 mb-4">ğŸ”º èï¼šè€ƒè©¦æ‡‰ç”¨</h3>
                                <div id="content-apply" class="text-gray-300 leading-relaxed whitespace-pre-wrap">
                                    é¸æ“‡ç¯€é»å¾Œé¡¯ç¤ºå…§å®¹...
                                </div>
                            </div>
                        </div>

                        <!-- æ“ä½œæŒ‰éˆ• -->
                        <div id="actionButtons" class="mt-6 flex gap-3 hidden">
                            <a href="ai_courses.html" class="flex-1 bg-slate-700 hover:bg-slate-600 py-3 rounded-lg font-medium text-center">
                                â† è¿”å›èª²ç¨‹
                            </a>
                            <button onclick="nextNode()" class="flex-1 bg-gradient-to-r from-blue-500 to-purple-600 hover:from-blue-400 hover:to-purple-500 py-3 rounded-lg font-bold">
                                ä¸‹ä¸€å€‹ â†’
                            </button>
                        </div>
                    </div>
                </div>

                <!-- å­¸ç¿’é€²åº¦ -->
                <div class="card rounded-xl p-4 mt-4">
                    <div class="flex justify-between items-center mb-2">
                        <span class="text-gray-400">å­¸ç¿’é€²åº¦</span>
                        <span id="progressText" class="text-sm">0 / 0</span>
                    </div>
                    <div class="h-2 bg-gray-700 rounded-full overflow-hidden">
                        <div id="progressBar" class="h-full bg-gradient-to-r from-blue-500 to-purple-500 rounded-full transition-all" style="width: 0%"></div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="py-8 border-t border-white/10 mt-8">
        <div class="container mx-auto px-4 text-center text-gray-500">
            <p>Â© 2025 åŒ—æ–—ä¸ƒæ˜Ÿæ–‡å‰µæ•¸ä½æœ‰é™å…¬å¸</p>
        </div>
    </footer>

    <script>
        let nodesData = null;
        let currentCert = 'google_ai';
        let currentNodeIndex = -1;
        let viewedNodes = new Set();

        const certInfo = {
            'google_ai': { name: 'Google AI Essentials', emoji: 'ğŸ¤–', color: 'from-blue-600 to-purple-600' },
            'ipas_ise': { name: 'iPAS è³‡è¨Šå®‰å…¨å·¥ç¨‹å¸«', emoji: 'ğŸ›¡ï¸', color: 'from-green-600 to-teal-600' }
        };

        // åˆå§‹åŒ–
        async function init() {
            try {
                const res = await fetch('data/nodes_cert_xtf.json');
                nodesData = await res.json();
                console.log(`è¼‰å…¥ AI: ${nodesData.meta.total_ai}, iPAS: ${nodesData.meta.total_ipas} ç¯€é»`);
                
                // è¼‰å…¥å·²æŸ¥çœ‹è¨˜éŒ„
                const saved = localStorage.getItem('beidou_cert_viewed');
                if (saved) viewedNodes = new Set(JSON.parse(saved));
                
                // URL åƒæ•¸
                const params = new URLSearchParams(window.location.search);
                const cert = params.get('cert');
                if (cert && nodesData[cert]) {
                    currentCert = cert;
                }
                
                selectCert(currentCert);
            } catch (e) {
                console.error('è¼‰å…¥å¤±æ•—:', e);
            }

            // ç™»å…¥ç‹€æ…‹
            const user = JSON.parse(localStorage.getItem('beidou_user') || 'null');
            if (user && !user.guest) {
                document.getElementById('authLink').textContent = user.username || 'æœƒå“¡';
                document.getElementById('authLink').href = 'dashboard.html';
            }
        }

        // é¸æ“‡è­‰ç…§
        function selectCert(cert) {
            currentCert = cert;
            currentNodeIndex = -1;
            
            // æ›´æ–°æŒ‰éˆ•æ¨£å¼
            document.querySelectorAll('.cert-btn').forEach(btn => {
                const isCurrent = btn.id === `btn-${cert}`;
                btn.className = `cert-btn w-full text-left p-3 rounded-lg border-2 transition-all ${
                    isCurrent 
                        ? `bg-gradient-to-r ${certInfo[cert].color} border-white/30`
                        : 'bg-slate-700 hover:bg-slate-600 border-transparent'
                }`;
            });
            
            loadNodes();
        }

        // è¼‰å…¥ç¯€é»åˆ—è¡¨
        function loadNodes() {
            const container = document.getElementById('nodeList');
            const nodes = nodesData[currentCert] || [];
            
            document.getElementById('nodeCount').textContent = `(${nodes.length})`;
            updateProgress();

            container.innerHTML = nodes.map((n, i) => {
                const isViewed = viewedNodes.has(n.node_id);
                return `
                    <div class="node-card card rounded-lg p-3 text-sm ${isViewed ? 'opacity-60' : ''}" onclick="selectNode(${i})">
                        <div class="flex items-center gap-2">
                            ${isViewed ? '<span class="text-green-400">âœ“</span>' : ''}
                            <span class="font-medium truncate">${n.name}</span>
                        </div>
                        <div class="text-xs text-gray-500 mt-1">
                            ${'â­'.repeat(Math.min(5, Math.ceil(n.importance / 20)))}
                        </div>
                    </div>
                `;
            }).join('');
        }

        // é¸æ“‡ç¯€é»
        function selectNode(index) {
            const nodes = nodesData[currentCert];
            const node = nodes[index];
            currentNodeIndex = index;

            // æ¨™è¨˜å·²æŸ¥çœ‹
            viewedNodes.add(node.node_id);
            localStorage.setItem('beidou_cert_viewed', JSON.stringify([...viewedNodes]));

            // æ›´æ–°é¸ä¸­ç‹€æ…‹
            document.querySelectorAll('.node-card').forEach((el, i) => {
                el.classList.toggle('selected', i === index);
            });

            // æ›´æ–°æ¨™é¡Œ
            const info = certInfo[currentCert];
            document.getElementById('nodeTitle').innerHTML = `
                <div class="flex items-center gap-3 mb-2">
                    <span class="cert-badge bg-gradient-to-r ${info.color}">${info.emoji} ${info.name}</span>
                </div>
                <h2 class="text-2xl font-bold mb-2">${node.name}</h2>
                <div class="flex items-center gap-4 text-sm text-gray-400">
                    <span>é‡è¦åº¦ï¼š${'â­'.repeat(Math.min(5, Math.ceil(node.importance / 20)))}</span>
                    <span>é›£åº¦ï¼š${'ğŸ”¥'.repeat(node.difficulty || 2)}</span>
                </div>
            `;

            // å¡«å…… XTF å…§å®¹
            document.getElementById('content-understand').textContent = node.understand || 'æš«ç„¡å…§å®¹';
            document.getElementById('content-memorize').textContent = node.memorize || 'æš«ç„¡å…§å®¹';
            document.getElementById('content-apply').textContent = node.apply || 'æš«ç„¡å…§å®¹';

            // é¡¯ç¤ºæ“ä½œæŒ‰éˆ•
            document.getElementById('actionButtons').classList.remove('hidden');
            
            // æ›´æ–°é€²åº¦
            updateProgress();
            loadNodes(); // é‡æ–°æ¸²æŸ“åˆ—è¡¨ä»¥é¡¯ç¤ºå·²æŸ¥çœ‹ç‹€æ…‹
            
            // é‡æ–°é¸ä¸­ç•¶å‰
            setTimeout(() => {
                document.querySelectorAll('.node-card')[index]?.classList.add('selected');
            }, 10);
        }

        // ä¸‹ä¸€å€‹ç¯€é»
        function nextNode() {
            const nodes = nodesData[currentCert];
            const nextIndex = (currentNodeIndex + 1) % nodes.length;
            selectNode(nextIndex);
            
            // æ»¾å‹•åˆ°è¦–åœ–
            document.querySelectorAll('.node-card')[nextIndex]?.scrollIntoView({ behavior: 'smooth', block: 'center' });
        }

        // æ›´æ–°é€²åº¦
        function updateProgress() {
            const nodes = nodesData[currentCert] || [];
            const viewed = nodes.filter(n => viewedNodes.has(n.node_id)).length;
            const total = nodes.length;
            const pct = total > 0 ? (viewed / total * 100) : 0;
            
            document.getElementById('progressText').textContent = `${viewed} / ${total}`;
            document.getElementById('progressBar').style.width = `${pct}%`;
        }

        // åˆ‡æ›æ¨™ç±¤
        function showTab(tab) {
            document.querySelectorAll('.xtf-tab').forEach(el => {
                const isActive = el.dataset.tab === tab;
                el.classList.toggle('active', isActive);
                el.classList.toggle('text-gray-400', !isActive);
                
                if (isActive) {
                    if (tab === 'understand') el.classList.add('text-blue-400', 'border-blue-400');
                    else if (tab === 'memorize') el.classList.add('text-purple-400', 'border-purple-400');
                    else if (tab === 'apply') el.classList.add('text-green-400', 'border-green-400');
                } else {
                    el.classList.remove('text-blue-400', 'border-blue-400', 'text-purple-400', 'border-purple-400', 'text-green-400', 'border-green-400');
                }
            });

            document.querySelectorAll('.xtf-content').forEach(el => {
                el.classList.toggle('active', el.id === `tab-${tab}`);
            });
        }

        init();
    </script>
</body>
</html>
